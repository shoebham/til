### Category javascript

---

 - [Accessing Arguments To A Function](#accessing-arguments-to-a-function)
 - [Basic Date Formatting Without A Library](#basic-date-formatting-without-a-library)
 - [Character Codes from Keyboard Listeners](#character-codes-from-keyboard-listeners)
 - [Check Classes On A DOM Element](#check-classes-on-a-dom-element)
 - [Check If A Number Is Positive Or Negative](#check-if-a-number-is-positive-or-negative)
 - [Check If Something Is An Array](#check-if-something-is-an-array)
 - [Check The Password Confirmation With Yup](#check-the-password-confirmation-with-yup)
 - [Compare The Equality Of Two Date Objects](#compare-the-equality-of-two-date-objects)
 - [Computed Property Names In ES6](#computed-property-names-in-es6)
 - [Conditionally Include Pairs In An Object](#conditionally-include-pairs-in-an-object)
 - [Configure Jest To Run A Test Setup File](#configure-jest-to-run-a-test-setup-file)
 - [Create A Cancelable Promise With PCancelable](#create-a-cancelable-promise-with-pcancelable)
 - [Create An Array Containing 1 To N](#create-an-array-containing-1-to-n)
 - [Create An Object With No Properties](#create-an-object-with-no-properties)
 - [Create Bootstrapped Apps With Yarn](#create-bootstrapped-apps-with-yarn)
 - [Create Future And Past Dates From Today](#create-future-and-past-dates-from-today)
 - [Custom Type Checking Error Messages With Yup](#custom-type-checking-error-messages-with-yup)
 - [Default And Named Exports From The Same Module](#default-and-named-exports-from-the-same-module)
 - [Define A Custom Jest Matcher](#define-a-custom-jest-matcher)
 - [Destructure With Access To Nested Value And Parent Value](#destructure-with-access-to-nested-value-and-parent-value)
 - [Destructuring The Rest Of An Array](#destructuring-the-rest-of-an-array)
 - [Enable ES7 Transforms With react-rails](#enable-es7-transforms-with-react-rails)
 - [Ensure Shell Can Find Global npm Binaries](#ensure-shell-can-find-global-npm-binaries)
 - [Easy Date Comparison With DayJS](#easy-date-comparison-with-dayjs)
 - [Expand Emojis With The Spread Operator](#expand-emojis-with-the-spread-operator)
 - [Fill An Input With A Ton Of Text](#fill-an-input-with-a-ton-of-text)
 - [Find The Version Of An Installed Dependency](#find-the-version-of-an-installed-dependency)
 - [Find Where Yarn Is Installing Binaries](#find-where-yarn-is-installing-binaries)
 - [for...in Iterates Over Object Properties](#for...in-iterates-over-object-properties)
 - [Formatting Values With Units For Display](#formatting-values-with-units-for-display)
 - [Freeze An Object, Sorta](#freeze-an-object,-sorta)
 - [Generate Random Integers](#generate-random-integers)
 - [Get The Location And Size Of An Element](#get-the-location-and-size-of-an-element)
 - [Get The Response Status From An Axios Error](#get-the-response-status-from-an-axios-error)
 - [Get The Time Zone Of The Client Computer](#get-the-time-zone-of-the-client-computer)
 - [Globally Install A Package With Yarn](#globally-install-a-package-with-yarn)
 - [Immutable Remove With The Spread Operator](#immutable-remove-with-the-spread-operator)
 - [Initialize A New JavaScript Project With Yarn](#initialize-a-new-javascript-project-with-yarn)
 - [Install The Latest Version Of Node With Nvm](#install-the-latest-version-of-node-with-nvm)
 - [Interpolate A String Into A Regex](#interpolate-a-string-into-a-regex)
 - [ISO-8601 Formatted Dates Are Interpreted As UTC](#iso-8601-formatted-dates-are-interpreted-as-utc)
 - [Link A JavaScript Package Locally](#link-a-javascript-package-locally)
 - [List Top-Level NPM Dependencies](#list-top-level-npm-dependencies)
 - [Make The Browser Editable With Design Mode](#make-the-browser-editable-with-design-mode)
 - [Matching A Computed Property In Function Args](#matching-a-computed-property-in-function-args)
 - [Matching Multiple Values In A Switch Statement](#matching-multiple-values-in-a-switch-statement)
 - [Mock A Function With Return Values Using Jest](#mock-a-function-with-return-values-using-jest)
 - [New Dates Can Take Out Of Bounds Values](#new-dates-can-take-out-of-bounds-values)
 - [Numbers Are Empty](#numbers-are-empty)
 - [Object Initialization With Shorthand Property Names](#object-initialization-with-shorthand-property-names)
 - [Obtain Undefined Value With The Void Operator](#obtain-undefined-value-with-the-void-operator)
 - [Parse A Date From A Timestamp](#parse-a-date-from-a-timestamp)
 - [Random Cannot Be Seeded](#random-cannot-be-seeded)
 - [Reach Into An Object For Nested Data With Get](#reach-into-an-object-for-nested-data-with-get)
 - [Render An Array Of Elements With React 16](#render-an-array-of-elements-with-react-16)
 - [Resolve And Pass Multiple Values From A Then](#resolve-and-pass-multiple-values-from-a-then)
 - [Running ES6 Specs With Mocha](#running-es6-specs-with-mocha)
 - [Scoping Variables With A Block Statement](#scoping-variables-with-a-block-statement)
 - [Sleep For A Bit In Async Code](#sleep-for-a-bit-in-async-code)
 - [Sorting Arrays Of Objects With Lodash](#sorting-arrays-of-objects-with-lodash)
 - [Splat Arguments To A Function](#splat-arguments-to-a-function)
 - [Spread The Rest With ES6](#spread-the-rest-with-es6)
 - [Start Node Process In Specific Timezone](#start-node-process-in-specific-timezone)
 - [String Interpolation With Template Literals](#string-interpolation-with-template-literals)
 - [Support Nested Matching In Custom Jest Matchers](#support-nested-matching-in-custom-jest-matchers)
 - [Tell Prettier To Not Format A Statement](#tell-prettier-to-not-format-a-statement)
 - [Test Coverage Stats With Jest](#test-coverage-stats-with-jest)
 - [Test Timing-Based Code With Jest Fake Timers](#test-timing-based-code-with-jest-fake-timers)
 - [The Comma Operator](#the-comma-operator)
 - [Throttling A Function Call](#throttling-a-function-call)
 - [Timing Processes](#timing-processes)
 - [Transforming ES6 and JSX With Babel 6](#transforming-es6-and-jsx-with-babel-6)
 - [Truthiness of Integer Arrays](#truthiness-of-integer-arrays)
 - [Turn An HTMLCollection Into An Array](#turn-an-htmlcollection-into-an-array)
 - [Turn Off Console Error Messages In A Test](#turn-off-console-error-messages-in-a-test)
 - [Waiting On Multiple Promises](#waiting-on-multiple-promises)
 - [Who Am I: NPM Edition](#who-am-i:-npm-edition)
 - [Yarn Commands Without The Emojis](#yarn-commands-without-the-emojis)
 - [Yup Schemas Are Validated Asynchronously ](#yup-schemas-are-validated-asynchronously-)

---

# Accessing Arguments To A Function

The `arguments` object is available within any JavaScript function. It is
an array-like object with all of the arguments to the function. Even if not
all of the arguments are referenced in the function signature, they can
still be accessed via the `arguments` object.

```javascript
function argTest(one) {
  console.log(one);
  console.log(arguments);
  console.log(arguments[1]);
}

argTest(1);
// 1
// [1]
// undefined

argTest(1, 'two', true);
// 1
// [1,'two',true]
// 'two'
```

See the [Arguments object
docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments)
on MDN for more details.

h/t Dorian Karter

# Basic Date Formatting Without A Library

JavaScript, on modern browsers, has an Internationalization API that, among
other things, provides some date formatting utilities. You can just start using
it, no need to import some massive date formatting library.

Here is a `Date` object:

```javascript
> const now = new Date();
> now
Tue Nov 19 2019 16:23:43 GMT-0600 (Central Standard Time)
```

The default formatting with this API is a good start:

```javascript
> Intl.DateTimeFormat('en-US').format(now)
"11/19/2019"
```

There are also a number of options for more advanced formatting. Here is the
`dateStyle` option with the four possible option values:

```javascript
> Intl.DateTimeFormat('en-US', { dateStyle: "full" }).format(now)
"Tuesday, November 19, 2019"
> Intl.DateTimeFormat('en-US', { dateStyle: "long" }).format(now)
"November 19, 2019"
> Intl.DateTimeFormat('en-US', { dateStyle: "medium" }).format(now)
"Nov 19, 2019"
> Intl.DateTimeFormat('en-US', { dateStyle: "short" }).format(now)
"11/19/19"
```

There is a lot more to this API including localization and custom formatting.
Check out the
[docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat)
for those details.

# Character Codes from Keyboard Listeners

If I create the following keyboard event listeners for `keydown`,
`keypress`, and `keyup`:

```javascript
window.addEventListener('keydown', function(e) { console.log("Keydown: " + e.charCode + ", " + e.keyCode); });
window.addEventListener('keypress', function(e) { console.log("Keypress: " + e.charCode + ", " + e.keyCode); });
window.addEventListener('keyup', function(e) { console.log("Keyup: " + e.charCode + ", " + e.keyCode); });
```

and then I press `A`, my browser console will read the following:

```
Keydown: 0, 65
Keypress: 65, 65
Keyup: 0, 65
```

and if I then press `a`, my browser console will read:

```
Keydown: 0, 65
Keypress: 97, 97
Keyup: 0, 65
```

The `keypress` event seems to be the way to go. Regardless, there seems to
be quite a bit of [incompatibility and lack of
support](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent#Browser_compatibility)
across browsers for various aspects of the keyboard events.

# Check Classes On A DOM Element

You can use the [`classList`
property](https://developer.mozilla.org/en-US/docs/Web/API/Element/classList)
to check what classes have been assigned to a DOM element.

Assuming the following DOM element:

```html
<div id="auth-modal" class="modal hidden">...</div>
```

Once you get a handle on that element, using your preferred method (e.g.
[`Document.getElementById`](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById)),
you can start inspecting the class list:

```javascript
> element.classList.contains("modal")
true

> element.classList.contains("hidden")
true

> element.classList.contains("taco")
false

> element.classList.toString()
"modal hidden"
```

# Check If A Number Is Positive Or Negative

The
[`Math`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math)
module has a handy function for checking if a number is _positive_ or
_negative_. Or _zero_, for that matter.

It is
[`Math.sign`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign).

```javascript
> Math.sign(5)
1

> Math.sign(-5)
-1

> Math.sign(0)
0
```

Any positive number will result in `1`. Any negative number will result in
`-1`. If the number happens to be `0`, then `0` will be returned.

This function goes real well with a switch statement.

Note also that anything that isn't a number will result in `NaN`.

```javascript
> Math.sign("one")
NaN
```

# Check If Something Is An Array

The `Array` class has a function on it called
[`isArray()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)
which can be used to check if something is an array.

```javascript
> Array.isArray('Hello, World!');
// => false

> Array.isArray(['One', 2, [3]]);
// => true

> Array.isArray({ foo: 'bar' });
// => false

> Array.isArray([]);
// => true
```

The MDN docs provide an [example
polyfill](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray#Polyfill)
if it is not natively available.

```javascript
if (!Array.isArray) {
  Array.isArray = function(arg) {
    return Object.prototype.toString.call(arg) === '[object Array]';
  };
}
```

# Check The Password Confirmation With Yup

The [Yup](https://github.com/jquense/yup) library makes it easy to validate
individual values in a JavaScript object. A common situation when
implementing a Sign Up form is asking the user to input their password twice
and then the app can make sure they match.

To do this, we need the validation of our `passwordConfirmation` value to
reach outside of itself to make a comparison with the `password` value. This
can be done with Yup's `ref` function.

```javascript
import * as Yup from 'yup';

validationSchema: Yup.object({
  password: Yup.string().required('Password is required'),
  passwordConfirmation: Yup.string()
     .oneOf([Yup.ref('password'), null], 'Passwords must match')
});
```

We are able to reference the value of `password` with `ref`. We use the
`oneOf` function to ensure that `passwordConfirmation` either matches
`password` or if it is left blank and matches `null` then it passes the
validation for the time being. The second argument to `oneOf` is a custom
validation message when this validation fails.

[source](https://github.com/jaredpalmer/formik/issues/90)

# Compare The Equality Of Two Date Objects

Equality can always feel like a bit of a moving target in JavaScript. Comparing
two objects, even if visually/conceptually identical, will resolve to being not
equal.

To compare two `Date` objects, you first need to convert them to something we
can check for equality -- numbers. This can be done with `getTime()`.

```javascript
> now = Date.now()
> today1 = new Date(now)
> today2 = new Date(now)
> today1 === today2
false
> today1.getTime() === today2.getTime()
true
```

With `Date` objects, you can directly use `<`, `>`, `<=`, and `>=`.

[source](https://stackoverflow.com/questions/492994/compare-two-dates-with-javascript)

# Computed Property Names In ES6

Perhaps more often than not, property names in an object are based on
something dynamic rather than a static value. In ES5, you may end up with
code like the following to build an object with dynamic property names:

```javascript
var dynamic1 = 'hello',
  dynamic2 = 'world';
var obj = {};
var propName1 = dynamic1 + dynamic2;
var propName2 = 5 * 11;
obj[propName1] = true;
obj[propName2] = false;

> obj
// { 55: false, 'helloworld': true }
```

With ES6, we get _computed property names_ which allow us to do all of these
inline when defining the object. We just have to wrap the code that will be
evaluated to a property name in brackets:

```javascript
const dynamic1 = 'hello',
  dynamic2 = 'world';
const obj = {
  [dynamic1 + dynamic2]: true,
  [5 * 11]: false
};

> obj
// { 55: false, 'helloworld': true }
```

Computed properties are [already available in many modern
browsers](https://kangax.github.io/compat-table/es6/#test-object_literal_extensions_computed_properties).

# Conditionally Include Pairs In An Object

You can add key-value pairs to an object using the ES6 spread operator:

```javascript
> { one: 1, ...{ hello: "world" } }
{ one: 1, hello: "world" }
```

By combining the spread operator with some boolean logic, you can conditionally
add key-value pairs to an object:

```javascript
> {
    one: 1,
    ...(isArriving && { hello: "world" }),
  }
```

Depending on the value of `isArriving`:

```javascript
// isArriving === true
{ one: 1, hello: "world" }
```

or

```javascript
// isArriving === false
{ one: 1 }
```

This is useful for dynamically building up some configuration object or data
payload.

# Configure Jest To Run A Test Setup File

Jest can be configured to run a setup file before each test. This is useful
for configuring your testing framework in a single place, rather than in
each test file.

This setup file can be specified in `package.json` (or `jest.config.js`).

```javascript
// package.json
{
  // ...
  "jest": {
    "setupTestFrameworkScriptFile": "<rootDir>src/setupTests.js"
  }
}
```

The
[`setupTestFrameworkScriptFile`](https://facebook.github.io/jest/docs/en/configuration.html#setuptestframeworkscriptfile-string)
points to a test setup file at the specified location rooted at `<rootDir>`
(the root of your project).

This kind of setup is helpful for something like
[Enzyme](https://github.com/airbnb/enzyme/blob/master/docs/guides/jest.md)
that needs to be configured with a specific adapter for use throughout your
tests.

# Create A Cancelable Promise With PCancelable

If an async task takes a really long time and we find out in the middle of
its execution that we no longer want the results of that activity, it would
be nice to be able to cancel that promise. There was a [proposal for
cancelable promises](https://github.com/tc39/proposal-cancelable-promises),
but it has since been withdrawn. There is an alternative though.

The [`p-cancelable`](https://github.com/sindresorhus/p-cancelable) package
provides a promise wrapper that acts as a cancelable promise.

```javascript
import PCancelable from 'p-cancelable';

const fetchPromise = new PCancelable((resolve, reject, onCancel) => {
  setTimeout(() => {
    resolve({ ok: true, data: [1, 2, 3] });
  }, 10000);

  onCancel(() => {
    console.log('Promise is being canceled');
  });
});

fetchPromise.then(response => {
  console.log('Promise Resolved: ', response.data);
}).catch(err => {
  console.log('Promise Rejected: ', err);
});

fetchPromise.cancel();
```

We can create a promise in a familiar manner. We get an additional argument
-- the `onCancel` function. This is a function that will be executed if
`cancel` is called before the promises has resolved or rejected. In the
above example, the `fetchPromise.cancel()` line will be invoked before the
`setTimeout` resolves. The promise will be canceled, causing a rejection
which will push us into the `catch` handler.

# Create An Array Containing 1 To N

Some languages, such as Ruby, have a built in range constraint that makes it
easy to construct an array of values from 1 to N. JavaScript is not one of
those languages. Nevertheless, if you don't mind the aesthetics, you can get
away with something like this:

```javascript
> Array.apply(null, {length: 10}).map(Number.call, Number);
=> [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
```

That gives us `0` through `9`. To get `1` through `10`, we can tweak it
slightly:

```javascript
> Array.apply(null, {length: 10}).map(Number.call, n => Number(n) + 1);
=> [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
```

To generalize this, we can replace `10` with `N` and then just expect that
`N` will be defined somewhere:

```javascript
> var N = 10;
=> undefined
> Array.apply(null, {length: N}).map(Number.call, n => Number(n) + 1);
=> [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
```

[Source](http://stackoverflow.com/a/20066663/535590) 

# Create An Object With No Properties

When you call `new Object` or even just instantiate an object with `{}`, you
are creating an object that uses the `Object` prototype. This means it
inherits from `Object.prototype`.

You can deliberately create an object with no properties by making sure that
it does not inherit `Object.prototype`.

```javascript
> const propertylessObject = Object.create(null);
{}

> propertylessObject.__proto__
undefined
```

Unlike most objects that we encounter as we write JavaScript, this object we
created with `Object.create(null)` has no properties including no
`__proto__`.

See
[Object.create](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create)
and
[Object.prototype](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/prototype)
for more details.

# Create Bootstrapped Apps With Yarn

The [`yarn` cli](https://yarnpkg.com/lang/en/docs/cli/) comes with a
[`create`](https://yarnpkg.com/blog/2017/05/12/introducing-yarn/) command
that is a convenience command for generating bootstrapped apps that follow
the `create-<name>-app` convention.

Want to create a React.js app using
[`create-react-app`](https://github.com/facebookincubator/create-react-app),
invoke the following command:

```
$ yarn create react-app my-app
```

Don't already have a particular package globally installed? `yarn create`
will install it for you. For instance, the following command with install
and use [`create-vue-app`](https://github.com/egoist/create-vue-app):

```
$ yarn create vue-app my-other-app
```

h/t Gabe Reis

# Create Future And Past Dates From Today

JavaScript's built-in
[`Date`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date)
object can be frustrating to work with at times.  It does, however, lend itself
nicely to some date math. You have to familiarize yourself with some of the API
and then it is a matter of addition and subtraction.

Here is today:

```javascript
const today = new Date();
// Tue Dec 01 2020 ...
```

Let's make a copy of today and send it 30 days into the future:

```javascript
const future = new Date(today);
future.setDate(future.getDate() + 30);
future
// Thu Dec 31 2020 ...
```

Or we could jump back a few years:

```javascript
const past = new Date(today);
past.setFullYear(past.getFullYear() - 4);
past
// Thu Dec 01 2016 ...
```

[source](https://stackoverflow.com/questions/7908098/javascript-set-date-30-days-from-now/7908122#7908122)

# Custom Type Checking Error Messages With Yup

In [Yup Schemas Are Validated
Asynchronously](https://github.com/jbranchaud/til/blob/master/javascript/yup-schemas-are-validated-asynchronously.md),
I showed how to create a simple schema that allows you to enforce that a
value is a number.

```javascript
const numSchema = yup.number();
```

If we use this schema to validate something that isn't a number, Yup will
provide a lengthy default message. Here is what we get if we validate against
`'hey'`:

> this must be a `number` type, but the final value was: `NaN` (cast from
> the value `"hey"`).

This value isn't necessarily suitable for displaying to a user. We can
customize the type checking error message by redefining our schema with the
`typeError()` function:

```javascript
const numSchema = yup.number().typeError("Invalid number");
```

# Default And Named Exports From The Same Module

ES6 module syntax allows for a single default export and any number of named
exports. In fact, you can have both named exports and a default export in
the same module.

Here is an example:

```javascript
// src/animals.js
export default function() {
  console.log('We are all animals!');
}

export function cat() {
  console.log('Meeeow!');
}

export function dog() {
  console.log('Rufff!');
}
```

In this case, you could import the default and named exports like so:

```javascript
// src/index.js
import animals, { cat, dog } from './animals.js';

animals(); // "We are all animals!"
cat();     // "Meeeow!"
dog();     // "Rufff!"
```

[source](http://2ality.com/2014/09/es6-modules-final.html)

# Define A Custom Jest Matcher

Though [Jest's built-in
matchers](https://jestjs.io/docs/en/expect) will get you pretty
far in most testing scenarios, you may find yourself in a testing situation
better served by a custom matcher. Custom matchers can be defined using the
[`expect.extend()`
function](https://jestjs.io/docs/en/expect#expectextendmatchers).

Here is an example of a matcher that can check equality of two objects based
solely on their `id` property.

```javascript
expect.extend({
  toHaveMatchingId(recieved, expected) {
    const pass = recieved.id === expected.id;

    if (pass) {
      return {
        pass: true,
        message: () =>
          `expected id:${expected.id} to not match actual id:${recieved.id}`
      };
    } else {
      return {
        pass: false,
        message: () =>
          `expected id:${expected.id} to match actual id:${recieved.id}`
      };
    }
  }
});
```

This defines the name of the matcher (`toHaveMatchingId`), contains some logic
to figure out whether `received` and `expected` pass the matcher, and then two
return conditions (`pass: true` and `pass: false`) with accompanying
message-returning functions.

It can then be used like any other Jest matcher:

```javascript
test("compare objects", () => {
  expect({ id: "001" }).toHaveMatchingId({ id: "001" });
  // ✅
  expect({ id: "001" }).toHaveMatchingId({ id: "002" });
  // ❌ expected id:002 to match actual id:001
});
```

Check out a [live example](https://codesandbox.io/s/focused-bush-vw2s5).

# Destructure With Access To Nested Value And Parent Value

A destructuring pattern that I often see (especially in React code) is to
peel off a nested value in the argument declaration of a function.

```javascript
const Component = ({ data: { name: displayName }}) => {
  return (
    <div>
      <h1>{displayName}</h1>
      <SubComponent />
    </div>
  );
};
```

On its own this works quite well, but what happens when you need access to
the full set of `data` as well as the nested `name` value? I often see this.

```javascript
const Component = ({ data }) => {
  const { name: displayName } = data;
  return (
    <div>
      <h1>{displayName}</h1>
      <SubComponent data={data} />
    </div>
  );
};
```

ES6 destructuring is flexible. You can skip the `const` line and keep
everything in the argument declaration.

```javascript
const Component = ({ data: { name: displayName }, data }) => {
  return (
    <div>
      <h1>{displayName}</h1>
      <SubComponent data={data} />
    </div>
  );
};
```

You can re-reference the `data` value after the nested destructuring.

# Destructuring The Rest Of An Array

ES6 offers some amount of pattern matching on arrays. This means you can do
fun stuff like grabbing a couple values and then destructuring the rest of
the array into a variable.

```javascript
> const kids = ["Mike", "Will", "Dustin", "Lucas", "Eleven", "Max"];
undefined
> const [first, second, ...rest] = kids;
undefined
> first
"Mike"
> second
"Will"
> rest
["Dustin", "Lucas", "Eleven", "Max"]
```

By using the `...` syntax with a variable name in the left-hand side of the
assignment, you are able to capture an array of whatever isn't assigned to
preceding variables.

# Enable ES7 Transforms With react-rails

The [`react-rails`](https://github.com/reactjs/react-rails) gem adds JSX and
ES6 transforms to the asset pipeline.  By using `.js.jsx` and `.es6.jsx`
extensions with relevant files, the asset pipeline will know to make the
appropriate transformation when compiling application assets. ES7 transforms
are not enabled by default, but can be configured. Add the following to the
`config/application.js` file to allow ES7's *class properties* syntax:

```ruby
config.react.jsx_transform_options = {
  optional: ["es7.classProperties"]
}
```

h/t Mike Chau

# Ensure Shell Can Find Global npm Binaries

When you install a package globablly either with yarn (or npm)

```bash
$ yarn global add vercel
```

It places the binaries for that package in the `bin` directory of your package
manager's configured path prefix.

The absolute path to this `bin` directory can be found with:

```bash
$ yarn global bin
/Users/jbranchaud/.asdf/installs/nodejs/15.4.0/.npm/bin
```

You can ensure that everything located in that `bin` directory is on your
shell's path by adding the following line to your shell's config file (e.g.
`.bashrc` or `.zshrc`).

```bash
export PATH="$PATH:$(yarn global bin)"
```

Once you've updated your shell config, make sure you _source_ the file or
restart your shell.

[source](https://stackoverflow.com/a/40333409/535590)

# Easy Date Comparison With DayJS

Let's say my application fetches dates from the server which come back in
string form as `"YYYY-MM-DD"` and I'd like to know if those dates already
passed. This can be done easily by wrapping dates in
[DayJS](https://github.com/iamkun/dayjs) and using its comparison functions.

```javascript
import dayjs from 'dayjs';

const today = dayjs(new Date());
const pastDate = dayjs("2018-10-22");
const futureDate = dayjs("2022-01-01");

console.log(pastDate.isBefore(today));
// => true
console.log(futureDate.isBefore(today));
// => false
```

The `dayjs()` function can be used to construct DayJS date objects from Date
objects and strings. These can then be compared with functions like
`isBefore()` and `isAfter()`.

# Expand Emojis With The Spread Operator

There are a number of emojis that are not stand-alone unicode characters,
but instead are [a combination of two or more other
emojis](http://unicode.org/emoji/charts/full-emoji-list.html#1f468_200d_1f469_200d_1f466).
The two main places this happens is with family emojis and emojis using
non-simpsons skin tones.

You can use JavaScript's spread operator to expand these emojis to see what
their base components are. Here is a screenshot of a few that I expanded
from Chrome's dev tools.

![](http://i.imgur.com/ObagJJ2.png)

[source](https://twitter.com/wesbos/status/769228067780825088)

# Fill An Input With A Ton Of Text

I needed to test out a form validation for an input that should render an
error when the length of the context exceeds 10,000 characters. Two small
tricks make this easy.

First, you can target any DOM element via the Chrome dev tools by selecting
it and then referencing it via the `$0` magic variable. [More details
here](https://developers.google.com/web/updates/2015/05/the-currently-selected-dom-node).

```javascript
> $0
<input>...</input>
```

Second, you can quickly and precisely generate a very long string with the
`repeat` function.

```javascript
> "a".repeat(10000)
"aaaaaaaaaaaaaaaaaaaaaaa..."
```

Combine these two tricks in the browser to fill the input with a ton of
text:

```javascript
> $0.value = "a".repeat(10000)
```

h/t Dillon Hafer

# Find The Version Of An Installed Dependency

I recently ran into a bug related to a specific version of a dependency. As
part of tracking it down, I needed to figure out what version I had installed.

The [`yarn list`](https://classic.yarnpkg.com/en/docs/cli/list) command can
help with this. Without any flags, it will show a tree structure listing _every
single_ dependency and sub-dependency that is installed for your project.

Here is an example of what that looks like restricted to a pattern of `jest`.

```bash
$ yarn list --pattern jest

yarn list v1.22.10
├─ @testing-library/jest-dom@5.14.1
├─ @types/jest@27.0.1
├─ @types/testing-library__jest-dom@5.9.5
│  ├─ @jest/types@26.6.2
│  ├─ @types/jest@26.0.23
│  ├─ jest-diff@26.6.2
│  └─ jest-get-type@26.3.0
...
```

I can look through this list and find the dependency and version of interest.

It's still a lot of results to comb through, so what I like to do instead is
pipe it to [`fzf`](https://github.com/junegunn/fzf).

```bash
$ yarn list | fzf
```

Then I can interactively narrow down the results with the power of FZF's fuzzy
finding functionality.

# Find Where Yarn Is Installing Binaries

When you run a command like:

```bash
$ yarn global add create-react-app
```

[Yarn](https://yarnpkg.com/lang/en/) is going to install any needed
dependencies including any binaries. So, where is Yarn putting these binaries?

Let's ask:

```bash
$ yarn global bin
/Users/jbranchaud/.asdf/installs/nodejs/10.15.3/.npm/bin
```

This is where it is located on my machine. You'll want to run it on your own
machine because the exact location will depend on the specifics of your
installation.

See [the docs](https://yarnpkg.com/lang/en/docs/cli/global/) for more details.

# for...in Iterates Over Object Properties

I don't reach for _for loops_ very often, so when I needed one recently I
thought I'd check out the newer `for...in` construct. It didn't behave quite
how I was expecting. I thought it would iterate over the values in the
target list, instead it seemed to be iterating over the indices.

The [MDN
docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...in)
explain what is going on:

> The `for...in` statement iterates over all non-Symbol, enumerable properties
> of an object.

An array is an object whose properties are the indices of the values stored
in the array.

```javascript
const fruits = ["apple", "banana", "orange"];
for (let fruit in fruits) {
  console.log(fruit, fruits[fruit]);
}
// => "0" "apple"
// => "1" "banana"
// => "2" "orange"
```

The iteration value wasn't what I was looking for, but in this case I can
use it to access the value from the list. I'd be better off using a standard
_for loop_ though.

# Formatting Values With Units For Display

There are all kinds of values and units your app may need to display. The
[`Intl.NumberFormat`
API](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NumberFormat)
that is available in modern browsers can help with standardizing that display.

How about formatting distances for display?

Here is a compact formatting of miles:

```javascript
> const milesFormat =
    Intl.NumberFormat("en-US", { style: "unit", unit: "mile" });
> milesFormat.format(1500)
"1,500 mi"
```

Here is two different formats for kilometers:

```javascript
> const kmFormat =
    Intl.NumberFormat("en-US", { style: "unit", unit: "kilometer" });
> kmFormat.format(1500)
"1,500 km"
> const kilometerFormat =
    Intl.NumberFormat("en-US", { style: "unit", unit: "kilometer", unitDisplay: "long" })
> kilometerFormat.format(1500)
"1,500 kilometers"
```

Give it a try with something else like `miles-per-hour`, `liter`, or `gallon`.

[source](https://twitter.com/jamesreggio/status/1196574375916400640?s=21)

# Freeze An Object, Sorta

You can freeze a JavaScript object using `Object.freeze` which will help
enforce some immutability practices. Don't be fooled though, you can still
modify arrays and objects in the frozen object.

Here is what the docs have to say:

> The Object.freeze() method freezes an object: that is, prevents new
> properties from being added to it; prevents existing properties from being
> removed; and prevents existing properties, or their enumerability,
> configurability, or writability, from being changed, it also prevents the
> prototype from being changed.

And here is `Object.freeze` in action:

```javascript
> const things = {one: "two", hello: "world", cats: ["Von Neumann", "Sosa"]}
undefined
> Object.freeze(things)
{one: "two", hello: "world", cats: Array(2)}

> things.one = "three"
"three"
> things.dogs = []
[]
> delete things.hello
false

> things
{one: "two", hello: "world", cats: Array(2)}

> things.cats.push("Sneaky")
3

> things
{one: "two", hello: "world", cats: Array(3)}
```

See the [MDN
Docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze)
for more details.

h/t Jake Worth

# Generate Random Integers

JavaScript's `Math` module has a built-in `random` function.

```javascript
> Math.random();
0.4663311937101857
```

It can be used to generate random floats between 0 and 1.

If you want integers, though, you're going to have to build your own function.

```javascript
function getRandomInt(max) {
  return Math.floor(Math.random() * Math.floor(max));
}

> getRandomInt(10);
1
> getRandomInt(10);
7
> getRandomInt(10);
2
```

This function allows you to randomly generate numbers between `0` (inclusive)
and `max`, a number you specify (exclusive).

[source](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random)

# Get The Location And Size Of An Element

[All modern browsers](https://caniuse.com/#feat=getboundingclientrect) ship
with the [`getBoundingClientRrect()`
function](https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect). It can be invoked for any DOM element. It returns the `x` and `y` coordinates of the element within the browser viewport as well as the `height` and `width` values and the `top` and `bottom` values along the `y-axis` and `left` and `right` values along the `x-axis`.

```javascript
> $0.getBoundingClientRect()
{
  "x": 381.421875,
  "y": 70,
  "width": 1030.578125,
  "height": 48,
  "top": 70,
  "right": 1412,
  "bottom": 118,
  "left": 381.421875
}
```

For instance, this is the result of invoking it against a header element on
the _MDN page_ linked above.

# Get The Response Status From An Axios Error

You can make API requests with [`axios`](https://github.com/axios/axios). If
the request fails because of a 4xx or 5xx response, an error will be raised.
The response to the request is stored on the error so that you can still access
the details of the response in your error handling logic.

Here is a snippet of code that details using async/await with `axios`. It wraps
the call in a `try/catch` block.

```javascript
async function getCharacter(characterId) {
  let response;

  try {
    response = await axios.get(
      `https://rickandmortyapi.com/api/character/${characterId}`
    );
  } catch (e) {
    response = e.response;
  }

  console.log(response.status);

  // You can also access the response data
  // console.log(response.data);
}

getCharacter(2);
//=> 200

getCharacter(2000);
//=> 404
```

In the case of the second call that results in a 404 response, the `catch`
block is executed. This pulls the `response` off the error (`e`).

Just like the standard response, the response from the error contains `status`,
`data`, `headers`, etc.

This also works with a promise-based control flow.

[Live Example](https://codesandbox.io/s/ancient-currying-5cmgm?file=/src/index.js)

# Get The Time Zone Of The Client Computer

The
[`resolvedOptions`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DateTimeFormat/resolvedOptions)
function on `Intl.DateTimeFormat.prototype` provides a number of pieces of
information about the client computer. It includes information such as the
locale and the numbering system. It also has the time zone for that machine.

Try running this line of JavaScript in your own browser.

```javascript
$ Intl.DateTimeFormat().resolvedOptions().timeZone
```

When I run it, I get `America/Chicago`.

You can use this within your client-side code as a way of determining in
which time zone your users are.

# Globally Install A Package With Yarn

I'm used to using the `-g` flag with `npm` to install packages globally.

```bash
$ npm install -g create-react-app
```

But how do I achieve the same thing with [`yarn`](https://yarnpkg.com/en/)?

By using the `global` command prefix, I can do a number of `yarn` tasks
globally, including adding a package.

```bash
$ yarn global add create-react-app
```

[source](https://yarnpkg.com/lang/en/docs/cli/global/)

# Immutable Remove With The Spread Operator

ES6 introduces the [spread
operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator)
which allows you to expand arrays in place for function calls, array
composition, array destructuring, etc. One thing the spread operator allows
you to concisely do with array composition is perform immutable operations
on arrays. For instance, to remove an item from an array by index, you can
throw together the following function.

```javascript
const remove = (items,index) => {
  return [...items.slice(0,index),
          ...items.slice(index+1,items.length)];
};

const list = [1,2,3,4,5];
remove(list, 2);
// [1,2,3,4]
list
// [1,2,3,4,5]
```

It only took a couple lines of code and immutability is baked in.

There may be a couple edge cases that are not handled in this solution (e.g.
`remove(list, -1)`), but you get the general idea.

# Initialize A New JavaScript Project With Yarn

Yarn, like NPM, has a basic command for initializing a new JavaScript
project.

```
$ yarn init
```

This will ask you a number of questions about your project like the name and
what kind of license you want to use. In the end, it just creates a
`package.json` file which can be used with `yarn` or `npm`.

# Install The Latest Version Of Node With Nvm

[Nvm](https://github.com/creationix/nvm), the Node Version Manager, is a
great way to manage multiple versions of Node.js on a machine. Run the
following command to get nvm to install the latest version of Node.js for
you.

```bash
$ nvm install node --reinstall-packages-from=node
```

[source](https://bytearcher.com/articles/ways-to-get-the-latest-node.js-version-on-a-mac/)

# Interpolate A String Into A Regex

You can build up strings with concatenation or the template literal syntax. If
you're incorporating variables as part of this string building, that's called
interpolation.

But what if you need to interpolate variables into a regular expression
(regex)?

A regex literal looks like this:

```javascript
const myRegex = /^Some Customizable Text$/;
```

This works great for fixed strings, but won't cut it if you need to work
_variable_ strings.

What's needed to work with variables is the
[`RegExp`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp)
constructor:

```javascript
const customizableString = "Some Customizable Text";
const myRegex = new RegExp(`^${customizableString}$`);
```

You can build up some string with string variables and regex syntax and `new
RegExp()` will turn it into a regex.

[source](https://makandracards.com/makandra/15879-javascript-how-to-generate-a-regular-expression-from-a-string)

# ISO-8601 Formatted Dates Are Interpreted As UTC

Using `new Date()` or `Date.parse()` with a string that represents a date is
a great way to create a `Date` object for a specified date. A variety of
formats are accepted by these methods.

But, caution!

There are subtle differences in how those dates will be interpreted. Given
any old string that reasonably represents a date, the date will be
interpreted using the local time zone, in my case `CST`.

```javascript
> new Date('2017-12-4')
Mon Dec 04 2017 00:00:00 GMT-0600 (CST)
```

However, as soon as we use an ISO-8601 compliant date format, ECMAScript 5
specifies that the date ought to be interpreted using the UTC time zone. As
you can see, the results are drastic enough to affect what day it comes out
to.

```javascript
> new Date('2017-12-04')
Sun Dec 03 2017 18:00:00 GMT-0600 (CST)
```

[Source](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse#ECMAScript_5_ISO-8601_format_support)

# Link A JavaScript Package Locally

If you are putting together a JavaScript package and you'd like to test it
out locally before putting it on NPM, use `npm link`.

First, from the directory of the package you are creating run:

```bash
$ npm link
```

This will symlink the package to the global node modules directory.

Then, from the base project directory that you want to try importing and
using the package from, run:

```bash
$ npm link name-of-package
```

This will create an additional symlink from the global node modules
directory to the `node_modules` of this target project.

You'll now have access to the project, try an `import` to get what you need
and try it out.

See `man npm-link` for more details.

# List Top-Level NPM Dependencies

The `npm ls` command can be used to list all dependencies for a project.
This will, however, produce an exhaustive list of all dependencies including
dependencies of dependencies. A list this large probably isn't going to be
of much use.

The `--depth` flag allows you to restrict the depth of the dependency tree
that is generated.

```bash
$ npm ls --depth=0
```

This will produce a list of only the top-level dependencies.

See `man npm-ls` for more details.

# Make The Browser Editable With Design Mode

Modern browsers support a Web API called _Design Mode_. When you turn on
_Design Mode_, you are able to edit the text on the web page like you would do
in Word or Dreamweaver. This is a great way to experiment with copy.

By default it is `"off"`, but you can turn it on from your browser's devtools
console.

```
> document.designMode = "on"
"on"
```

[source](https://developer.mozilla.org/en-US/docs/Web/API/Document/designMode)

# Matching A Computed Property In Function Args

The [computed property name](http://es6-features.org/#ComputedPropertyNames)
feature of ES6 allows you to reference a variable in object assignments and
destructurings. This syntax is flexible enough that it can be used in the
arguments portion of a function declaration. In fact, it can even be matched
against another argument -- allowing the creation of some handy, yet terse
functions.

```javascript
const get = (key, { [key]: foundValue }) => foundValue;
```

Notice that the first argument, `key`, will match against the computed
property name in the second argument. The `foundValue` will correspond to
whatever `key` maps to in the given object.

This `get` function can then be used like so.

```javascript
const stuff = { a: 1, b: 2, c: 3 };

console.log("Get a:", get("a", stuff)); // Get a: 1
console.log("Get d:", get("d", stuff)); // Get d: undefined
```

h/t
[@sharifsbeat](https://twitter.com/sharifsbeat/status/1084235020183748610)

# Matching Multiple Values In A Switch Statement

Switch statements are a handy way to execute different branches of code
based on a value match. This is often what is used in Redux reducers when
updating the state in response to certain actions.

But what if you need multiple values to result in the same branch of
execution without duplicating the code?

The execution of a switch statement falls through, so after one match, it
will continue to try and do subsequent matches if you don't interrupt the
execution with a `break` or `return`. Conveniently, this solves our problem
of matching multiple values.

```javascript
switch (action.type) {
  case "UPDATE_NAME":
  case "UPDATE_DURATION":
    let newData = anotherReducer(state.data, action);
    return { ...state, data: newData };
  default:
    return state;
}
```

See the [MDN
docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/switch)
for more details.

# Mock A Function With Return Values Using Jest

[Jest](https://facebook.github.io/jest/) provides a collection of utilities
for working with mocked functions.  To create a mock function, do:

```javascript
jest.fn()

// assign it to a variable
const fakeFunc = jest.fn();

// pass it as a prop
<SpecialInput handleChange={jest.fn()} />
```

A mocked function can then be attributed with a return value.

```javascript
const fakeFunc = jest.fn();
fakeFunc.mockReturnValue("hello");
fakeFunc(); // => "hello"
```

The
[`mockReturnValue()`](https://facebook.github.io/jest/docs/en/mock-function-api.html#mockfnmockreturnvaluevalue)
function ensures that the value is returned whenever your function is
called.

We can also limit the return value to occurring just once.

```javascript
const fakeFunc = jest.fn();
fakeFunc.mockReturnValueOnce("hello");
fakeFunc(); // => "hello"
fakeFunc(); // => null
```

[`mockReturnValueOnce()`](https://facebook.github.io/jest/docs/en/mock-function-api.html#mockfnmockreturnvalueoncevalue)
ensures the value is returned once and all subsequent calls yield `null`.

# New Dates Can Take Out Of Bounds Values

You can create a new date by feeding it arguments for _year_, _month_, and
_day_.

```javascript
> new Date(2017, 11, 31)
Sun Dec 31 2017 00:00:00 GMT-0600 (CST)
```

What happens if we push the _day_ value out of bounds?

```javascript
> new Date(2017, 11, 32)
Mon Jan 01 2018 00:00:00 GMT-0600 (CST)
```

It rolls over to the next month.

Does the same happen when we push the _month_ value out of bounds?

```javascript
> new Date(2017, 12, 31)
Wed Jan 31 2018 00:00:00 GMT-0600 (CST)
```

Yep.

What about negative values?

```javascript
> new Date(2018, -1, 31)
Sun Dec 31 2017 00:00:00 GMT-0600 (CST)
```

It rolls the month, and consequently the year, back.

# Numbers Are Empty

The [`lodash`](https://lodash.com/) project comes with a ton of handy
JavaScript utilities including the
[`_.isEmpty()`](https://lodash.com/docs#isEmpty) function. This is great for
checking if Arrays, Objects, and Strings are _empty_. The following is how
this function is defined in the docs:

> Checks if value is an empty collection or object. A value is considered
> empty if it's an arguments object, array, string, or jQuery-like
> collection with a length of 0 or has no own enumerable properties.

Having not examined this definition too closely and because I primarily
write Rails code from day to day, I conflated `_.isEmpty()` with the
`#blank?` method provided by Rails' `ActiveSupport`. This holds true for the
most part, but quickly defies expectations when it comes to numbers.

```javascript
> _.isEmpty(1)
// true
```

# Object Initialization With Shorthand Property Names

If I have some variables:

```javascript
const one = 1,
  two = 2,
  three = 3;
```

and I'd like to initialize an object with them, I'll generally do something
like the following:

```javascript
const obj1 = {
  one: one,
  two: two,
  three: three
};
// Object { one: 1, two: 2, three: 3 }
```

That seems pretty standard, but with ES6 comes a feature called *shorthand
property names* which makes that look verbose and redundant. If you already
have properly named variables, they can be used as a short hand for both the
key name and variable value:

```javascript
const obj2 = {
  one,
  two,
  three
};
// Object { one: 1, two: 2, three: 3 }
```

See the [MDN Docs for Object
Initializer](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer)
for more details.

# Obtain Undefined Value With The Void Operator

The [`void`
operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/void)
takes any expression, evaluates it, and then results in the `undefined` value.
A common use of the `void` operator is to get the primitive `undefined` value
in a consistent way.

```javascript
> void(0);
undefined
```

This is handy for instances where you need to check if a value is `undefined`:

```javascript
function doSomething({ arg }) {
  if (arg === void 0) {
    throw new Error("arg is undefined 😱");
  }

  // ...
};
```

# Parse A Date From A Timestamp

If you are given a timestamp ([seconds since the Unix
epoch](https://stackoverflow.com/a/20823376/535590)) and you try to parse it
with [JavaScript's `new
Date()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/Date),
you are going to get a suprising result.

```javascript
> new Date(1618499080)
Mon Jan 19 1970 11:34:59 GMT-0600 (Central Standard Time)
```

1970? I was expected something more in the current millenia.

This is because JavaScript's `new Date()` expects a timestamp to be in milliseconds. Passing in a seconds representation of a timestamp, when it should be milliseconds, is going to result in a time pretty near the original Unix epoch.

Instead what you need to do is multiple that _seconds_ value by `1000` to get
it in terms of milliseconds.

```javascript
> new Date(1618499080 * 1000)
Thu Apr 15 2021 10:04:40 GMT-0500 (Central Daylight Time)
```

Also, notice that if I run [`+ new
Date()`](https://stackoverflow.com/a/221297/535590) without any argument, it
provides the current timestamp in milliseconds.

```javascript
> + new Date()
1618499080598
```

# Random Cannot Be Seeded

In JavaScript, you can use `Math.random()` to get a *sorta* random value.

```javascript
> Math.random()
0.5130641541909426
```

Most programming languages give you a method of seeding the random number
generator for determinism. Unfortunately, JavaScript provides no way for
choosing or resetting the seed to `Math.random()`.

[source](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random)

# Reach Into An Object For Nested Data With Get

Among the many [lodash](https://lodash.com/) utilities is
[`_.get`](https://lodash.com/docs/4.17.5#get) for getting data from nested
objects. You can specify where to reach into the nested data of an object
using a _path_.

Consider the following awkwardly nested object:

```javascript
const resp = {
  error: {
    errors: [
      { message: "Something went wrong" },
    ],
  },
};
```

Here is how we might reach into this with vanilla JavaScript:

```javascript
resp.error.errors[0].message;
```

Reaching into this for the `message` value is tricky because as soon as the
`resp` object contains differently nested data, an error is likely to be
thrown. We can simultaneously avoid a bunch of exception handling logic and
provide a default value with the `_.get` function:

```javascript
_.get(resp, 'error.errors[0].message', 'Default error message');
```

If we decide to not include a default value, then `undefined` will be used.

# Render An Array Of Elements With React 16

[React 16 was released
today](https://facebook.github.io/react/blog/2017/09/26/react-v16.0.html).
Among many exciting features and updates is support for rendering an array
of elements.

This can look as simple as this example:

```javascript
return [
  <li key="1">One</li>,
  <li key="2">Two</li>,
  <li key="3">Three</li>
];
```

It really shines in the case of generating elements from an array of data.

```javascript
let data = [
  { value: "One", key: "1" },
  { value: "Two", key: "2" },
  { value: "Three", key: "3" }
];
return data.map(item => {
  return (
    <li key={item.key}>
      {item.value}
    </li>
  );
});
```

No need to wrap the result in a `<div>`!

[source](https://facebook.github.io/react/docs/react-component.html#render)

# Resolve And Pass Multiple Values From A Then

Let's say you are chaining multiple async function calls together.

```javascript
fetchTrainer(trainerName)
  .then(response => {
    const trainerData = response.body;

    return fetchPokemonFor({ trainerId: trainerData.id });
  })
  .then(response => {
    // I want trainerData, but it is now out of scope...
  });
```

But in the last `then()` you want access to both the `trainerData` and the
`pokemonData`. So, how do you pass both the `trainerData` and the resolved
response of `fetchPokemonFor()` through to that last `then()`.

```javascript
fetchTrainer(trainerName)
  .then(response => {
    const trainerData = response.body;

    return Promise.all([
      trainerData,
      fetchPokemonFor({ trainerId: trainerData.id })
    ]);
  })
  .then(([trainerData, pokemonResponse]) => {
    const pokemonData = pokemonResponse.body;

    // do something with trainerData and pokemonData
  });
```

`Promise.all` allows us to resolve and pass multiple promises. If any of the
values in the array argument is not a promise, it simply passes it through.

h/t Brian Dunn

# Running ES6 Specs With Mocha

If your JavaScript specs contain ES6 syntax, [Mocha](https://mochajs.org/),
by default, will not be able to interpret and run them. In order to run them
with Mocha, you will need to tell Mocha to use something like
[Babel](http://babeljs.io/) to compile them. The `--compile` flag can be
used to point Mocha to the `babel-core/register` package.

```
$ mocha --compilers js:babel-core/register path/to/specs/*.spec.js
```

If you already have a test command specified in your `package.json` file,
you can update it with the `--compile` portion of the above command.

This all assumes you've already setup your project with Babel and Babel
presets.

[source](http://jamesknelson.com/testing-in-es6-with-mocha-and-babel-6/)

# Scoping Variables With A Block Statement

A solid way to keep code readable and easy to understand is to ditch the
terse one-liners in favor of breaking things up across multiple lines and
using self-documenting variable names. This isn't all good though. Each new
variable that is defined is a handle on some data that can be misused later
in the syntax scope.

JavaScript has a nice way of being clear about the scope of certain
variables:

```javascript
let parsedDate;
{
  let [month, day, year] = input.split('-');
  parsedDate = new Date(year, month, day);
}

// do something with parsedDate
```

The `month`, `day`, and `year` variables are scoped to the `{ ... }` which
is a [block
statement](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/block).
This helps communicate and enforce that those variables are only to be used
in that very specific context. Other developers and our future selves won't
be able to erroneously use those variables.

Of course, breaking out a function is another way of accomplishing this.
Sequestering code in a different part of the file is not always the best
answer though. Sometimes you want it locally fenced off. For those times,
use a block statement.

# Sleep For A Bit In Async Code

A `sleep` utility function can be useful in a variety of situations. From
testing and debugging to simulating a delay in development.

Here is what that function can look like in its simplest form:

```javascript
function sleep(time) {
  return new Promise((resolve) => {
    setTimeout(resolve, time)
  })
}
```

This function returns a promise that will resolve after the given number of
milliseconds.

As an example of how to use it, here is how we can simulate a delay in a fake
fetch function.

```javascript
async function fakeUserFetch(userId) {
  # add half a second of "network" latency
  await sleep(500)

  const fakeResponse = {
    id: userId,
    email: "fake-email@example.com"
  }

  return Promise.resolve(fakeResponse)
}
```

[source](https://stackoverflow.com/a/951057/535590)

# Sorting Arrays Of Objects With Lodash

The [`lodash`](https://lodash.com/) library comes with a couple functions for
sorting collections of objects --
[`sortBy`](https://lodash.com/docs/4.17.15#sortBy) and
[`orderBy`](https://lodash.com/docs/4.17.15#orderBy).

Consider the following collection of pokemon:

```javascript
const pokemon = [
  { name: "Pikachu", level: 12 },
  { name: "Charmander", level: 12 },
  { name: "Squirtle", level: 15 },
  { name: "Bulbasaur", level: 11 }
];
```

This collection can be sorted in ascending order by the value of a key in the
object using `sortBy`.

```javascript
import _sortBy from "lodash/sortBy";

_sortBy(pokemon, ["level"]);
```

If you want to control whether the sorting is in ascending or descending order,
use `orderBy`.

```javascript
import _orderBy from "lodash/orderBy";

_orderBy(pokemon, ["level"], ["desc"]);
```

You can also do sorting with primary and secondary keys by including two values
in the key sort array.

```javascript
import _sortBy from "lodash/sortBy";

_sortBy(pokemon, ["name", "level"]);
```

And if you want to indpendently control ascending/descending for these as well,
you can.

```javascript
import _orderBy from "lodash/orderBy";

_orderBy(pokemon, ["level", "name"], ["desc", "asc"]);
```

Check out the [live example](https://codesandbox.io/s/jolly-ardinghelli-cem7t)
to see it in action.

# Splat Arguments To A Function

Often times you have a function that takes a certain set of arguments. Like
the following `adder` function:

```javascript
var adder = function(a,b,c) {
  return a + b + c;
};
```

But you are left trying to pass in arguments as an array (e.g. `[1,2,3]`).
You want to be able to *splat* the array of arguments so that it matches the
function declaration. This can be done by using `apply`.

```javascript
> adder.apply(undefined, [1,2,3])
6
```

# Spread The Rest With ES6

The spread operator provided by ES6 is a powerful syntactic feature. One way
it can be used is to capture the _rest_ of an object or array in a variable.

```javascript
const pokemon = ["Charmander", "Squirtle", "Bulbasaur"];
const [first, ...rest] = pokemon;

console.log("Remaining: ", rest); // Remaining: ["Squirtle", "Bulbasaur"]

const gymLeaders = {
  brock: "rock",
  misty: "water",
  surge: "electric",
  erika: "grass"
};
let { brock, erika, ...otherLeaders } = gymLeaders;

console.log(otherLeaders); // Object {misty: "water", surge: "electric"}
```

Using this spread destructuring we can capture the remaining parts of an
array or object in a variable. We can also use this syntax in a function
signature to grab specific items from an incoming object argument without
losing track of the rest -- this is especially useful in React.js
development when dealing with incoming props.

This is a [stage 4
feature](https://github.com/tc39/proposal-object-rest-spread) and may not be
available in your particular environment.

See a [live example here](https://codesandbox.io/s/ov2xr1o12y).

# Start Node Process In Specific Timezone

When running a node process on your machine locally, it will adopt your
machine's local timezone.

I can observe this by starting a `node` process and outputting a date with
`toLocaleString()`.

```javascript
> new Date().toLocaleString()
'11/30/2020, 8:48:17 PM'
```

This is the time that I'm writing this post, in Chicago (CST).

I can then start the process in another timezone, such as UTC.

```bash
$ TZ=utc node
```

With that `node` process, I can now do the same experiment.

```javascript
> new Date().toLocaleString()
'12/1/2020, 2:52:40 AM'
```

The time jumps ahead about 6 hours because it is going from CST (UTC-6) to UTC.

Similarly, I could start the Node process for the west coast like so,

```bash
$ TZ='America/Los_Angeles' node
```

# String Interpolation With Template Literals

ES6 adds support for [template
literals](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals).
Template literals make it much easier to compose strings of content --
string interpolation. They allow for single and double quotes without having
to fuss with escaping.  Embedded expressions are also supported which means
you can avoid awkward-to-type string concatenation with the `+` operator.

Here is an example:

```javascript
> let movie = 'it'
undefined
> `What's up, I just saw "${movie.toUpperCase()}".`
"What's up, I just saw "IT"."
```

# Support Nested Matching In Custom Jest Matchers

A [custom Jest matcher](define-a-custom-jest-matcher) can use standard
JavaScript operations to evaluate if the given value(s) should pass or not.

```javascript
expect.extend({
  toContainValue(receivedArray, containedValue) {
    const pass =
      receivedArray.some(value => value === containedValue);

    // return formatted pass/not-pass objects with messages
    return { ... }
  }
});
```

This approach alone doesn't support the power of Jest's nested matchers.
Consider trying to use this like so:

```javascript
expect(['a', 2, true]).toContainValue(expect.any(Number));
```

This would fail, even though there is a value in there that matches
`any(Number)`.

Jest ships with some [Jasmine](https://jasmine.github.io/) utilities that you
can use, just as Jest does internally, to perform nested matching:

```javascript
const { equals } = require("expect/build/jasmineUtils");

expect.extend({
  toContainValue(receivedArray, containedValue) {
    const pass =
      receivedArray.some(value => equals(value, containedValue));

    // return formatted pass/not-pass objects with messages
    return { ... }
  }
});
```

That `equals` utility knows how to compare raw values like integers, booleans,
and even whole objects against nested `expect` matchers.

[source](https://github.com/facebook/jest/issues/8295#issuecomment-482545274)

# Tell Prettier To Not Format A Statement

[Prettier](https://prettier.io/) is a boon to productivity because individuals
and teams don't have to make any decisions about the fine details of how their
code is formatted. Generally, let `prettier` do its thing.

There are some situations where you want to preserve your own formatting,
especially if it improves readability.

Here is some `prettier` formatted code:

```javascript
const relativeCoords = {
  A: [xPos - 1, yPos - 1],
  B: [xPos, yPos - 1],
  C: [xPos + 1, yPos - 1],
  D: [xPos - 1, yPos],
  E: [xPos + 1, yPos],
  F: [xPos - 1, yPos + 1],
  G: [xPos, yPos + 1],
  H: [xPos + 1, yPos + 1],
};
```

Originally, I included some whitespace to keep things visually aligned. If I
include a `prettier-ignore` comment, the statement immediately following it
will not be touched by prettier.

```javascript
// prettier-ignore
const relativeCoords = {
  A: [xPos - 1, yPos - 1],
  B: [xPos    , yPos - 1],
  C: [xPos + 1, yPos - 1],
  D: [xPos - 1, yPos    ],
  E: [xPos + 1, yPos    ],
  F: [xPos - 1, yPos + 1],
  G: [xPos    , yPos + 1],
  H: [xPos + 1, yPos + 1],
};
```

[source](https://prettier.io/docs/en/ignore.html#javascript)

# Test Coverage Stats With Jest

[Jest](https://facebook.github.io/jest/) is a delightful tool for JavaScript
testing from Facebook. As your project evolves and you add tests (or perhaps
choose to not add tests) you may wonder what kind of test coverage you have.
What is the overall coverage? Which files are well covered and which are
seriously lacking?

Use the `--coverage` flag to get this information.

```bash
$ jest --coverage
```

After running all of your tests a table will be output to the terminal with
a list of files and their respective coverage percentages in terms of
statement, branch, function, and line coverage.

```
---------------------------|----------|----------|----------|----------|----------------|
File                       |  % Stmts | % Branch |  % Funcs |  % Lines |Uncovered Lines |
---------------------------|----------|----------|----------|----------|----------------|
```

This can help guide you to what parts of your app may need more testing.

# Test Timing-Based Code With Jest Fake Timers

In real-world code we use timeouts to do things like debouncing and throttling
of functions. This is really hard to test efficently and accurately with basic
test runner tooling.

Jest, however, offers some [Timer Mock
tooling](https://jestjs.io/docs/en/timer-mocks) that removes most of the
complexity of getting this right.

Here is a method to test:

```javascript
const doSomethingAfter200ms = doSomething => {
  setTimeout(() => {
    doSomething();
  }, 200);
};
```

A test that shows this to work would have to observe `doSomething` getting
called after 200ms.

The following test won't work because the expectation is evaluated before the
timeout function is triggered.

```javascript
describe("doSomethingAfter200ms", () => {
  test("does something after 200ms (fail)", () => {
    const doSomething = jest.fn();

    doSomethingAfter200ms(doSomething);

    expect(doSomething).toHaveBeenCalled();
  });
});
```

By activating `jest.useFakeTimers()`, we can simulate the passing of 200ms and
then check that our mocked function was called.

```javascript
jest.useFakeTimers();

describe("doSomethingAfter200ms", () => {
  test("does something after 200ms (pass)", () => {
    const doSomething = jest.fn();

    doSomethingAfter200ms(doSomething);

    jest.advanceTimersByTime(201);

    expect(doSomething).toHaveBeenCalled();
  });
});
```

Jest's function mocks and timer mocks make this possible.

# The Comma Operator

I was surprised to see the result of this line of code:

```javascript
const what = (1,2,3,4);
console.log(what); //=> 4
```

I asked around on
[twitter](https://twitter.com/jbrancha/status/1084936559323951105) and
learned that the syntax construct at play here is the [comma
operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comma_Operator).

> The comma operator evaluates each of its operands (from left to right) and
> returns the value of the last operand.

And that is why `what` gets bound to `4`.

# Throttling A Function Call

Imagine you have a JavaScript function that makes a request to your server.
Perhaps it is sending user input from a `textarea` to be processed by the
server. You may want to wrap this function in a keyboard event listener so
that you are sure to react immediately to any user input. However, as the
user starts typing away into this text area you may find that way to many
requests are being fired off to the server. The request needs to be
*throttled*.

You can roll your own approach to sufficiently intermittent server calls.
Though, it turns out that [underscore.js](http://underscorejs.org/) comes
with two functions out of the box for this kind of behavior.

- [`throttle`](http://underscorejs.org/#throttle) will give you a function
  that wraps your function in a way that essentially rate-limits it to being
  called at most once every `N` milliseconds.

- [`debounce`](http://underscorejs.org/#debounce), on the other hand, will
  give you a function that only calls your function once `N` milliseconds
  has passed since it was last called.

These are two subtly different approaches to making sure a function gets
called, just not too often.

h/t [Jake Worth](https://twitter.com/jwworth)

# Timing Processes

If you want to time a process, you can use the `console.time()` and
`console.timeEnd()` utilities specified by the `console` Web API. Invoking
`console.time()` with a label starts a named timer. You can then run the
process you want to time. Then invoke `console.timeEnd()` with the same
label to terminate the timer and see how long the process took.

```javascript
console.time('sorting');
[11,10,9,8,7,6,5,4,3,2,1].sort();
console.timeEnd('sorting');
> sorting: 0.278ms

console.time('console logging');
console.log('logging to the console');
console.timeEnd('console logging');
> logging to the console
> console logging: 0.311ms

console.time('adding'); 1 + 1; console.timeEnd('adding');
> adding: 0.006ms
```

These functions are implemented in most modern browsers.

See [the
docs](https://developer.mozilla.org/en-US/docs/Web/API/Console/time) for
more details.

# Transforming ES6 and JSX With Babel 6

With Babel 5, transforming ES6 and JSX into ES5 code was accomplished by
including the `babel-loader`. This would be configured in
`webpack.config.js` with something like the following:

```javascript
module: {
  loaders: [
    {
      test: /\.jsx?$/,
      exclude: /node_modules/,
      loader: 'babel-loader',
    }
  ],
},
```

Now, with Babel 6, the different parts of the loader have been broken out
into separate plugins. These plugins need to be installed

```
$ npm install babel-preset-es2015 babel-preset-react --save-dev
```

and then included as presets

```javascript
module: {
  loaders: [
    {
      test: /\.jsx?$/,
      exclude: /node_modules/,
      loader: 'babel-loader',
      query: {
        presets: ['es2015', 'react']
      },
    }
  ],
},
```

Alternatively, the presets can be specified in the project's `.babelrc` file.

[Source](http://jamesknelson.com/the-six-things-you-need-to-know-about-babel-6/)

# Truthiness of Integer Arrays

We can consider the truthiness of `[1]` as follows:

```javascript
> [1] == true
=> true
> Boolean(true)
=> true
> Boolean([1])
=> true
```

We can consider the truthiness of `[0]` as follows:

```javascript
> [0] == false
=> true
> Boolean(false)
=> false
> Boolean([0])
=> true
```

The truthiness of `[0]` does not seem to be consistent.

See this [JavaScript Equality Table](https://dorey.github.io/JavaScript-Equality-Table/)
for more details.

# Turn An HTMLCollection Into An Array

If you are using any of the built-in document query utilities, such as
[`getElementsByClassName()`](https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByClassName):

```javascript
> document.getElementsByClassName("some-class")
HTMLCollection(5) [ ... ]
```

Then you are going to get an
[`HTMLCollection`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLCollection)
in response. An instance of this cannot be iterated over, so you cannot call
things like `map` and `filter` against it.

To use Array collection methods, you are first going to need to turn the
`HTMLCollection` into an array. You can do this with
[`Array.from`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from):

```javascript
> Array.from(document.getElementsByClassName("some-class"))
[ ... ]
```

[source](https://medium.com/@chuckdries/traversing-the-dom-with-filter-map-and-arrow-functions-1417d326d2bc)

# Turn Off Console Error Messages In A Test

I'm using [Jest](https://facebook.github.io/jest/) to test a React component
that requires a prop via
[PropTypes](https://reactjs.org/docs/typechecking-with-proptypes.html). In
one of my tests, I want to test that component when the required prop is
excluded. The side effect of doing this is that my test output gets
cluttered with the PropType warning.

The thing to do is silence the error message during that test.

```javascript
it('renders a component without a required prop', () => {
  const originalError = console.error;
  console.error = jest.fn();

  // test code here
  expect(shallow(<My Component />)).toDoSomething;

  console.error = originalError;
});
```

We can silence `console.error` by temporarily replacing it with a
Jest-mocked function and then putting it back at the end of the test.

# Waiting On Multiple Promises

You may find yourself in a situation where you have to request multiple
resources from multiple API endpoints and then combine that data in some
way.

One way to achieve this would be with nested promises.

```javascript
fetch('/blogs').then((response) => {
  let blogs = response.body;

  fetch('/tags').then((response) => {
    let tags = response.body;

    // combine blogs and tags ...
  })
})
```

This nesting isn't ideal and it can get hard to read as the full
implementation is put into place.

The `Promise` API provides an alternative.

```javascript
let blogsPromise = fetch('/blogs')
let tagsPromise = fetch('/tags')

Promise.all([blogsPromise, tagsPromise]).then(([blogsResp, tagsResp]) => {
  // combine blogs and tags ...
})
```

With
[`Promise.all()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all)
we are able to wrap any number of promises and wait for all of them to
resolve until we do something with the results. This allows us to create a
context in which we have all the data we need without a bunch of nesting.

# Who Am I: NPM Edition

Want to know who has been configured as the current user via the NPM CLI?

```bash
$ npm whoami
```

See `man npm-whoami` for more details.

# Yarn Commands Without The Emojis

If you are a hater and you'd like to run [`yarn`](https://yarnpkg.com/en/)
commands without emojis being playfully included in the output, just include
the `--no-emoji` flag.  The output of a command like `add` will look like
this:

```bash
$ yarn add chalk --no-emoji
yarn add v0.17.10
[1/4] Resolving packages...
[2/4] Fetching packages...
[3/4] Linking dependencies...
[4/4] Building fresh packages...
success Saved lockfile.
success Saved 7 new dependencies.
├─ ansi-styles@3.1.0
├─ chalk@2.0.1
├─ color-convert@1.9.0
├─ color-name@1.1.3
├─ escape-string-regexp@1.0.5
├─ has-flag@2.0.0
└─ supports-color@4.2.0
Done in 0.54s.
```

See `yarn help` for details.

# Yup Schemas Are Validated Asynchronously 

[Yup](https://github.com/jquense/yup) provides a flexible object schema
validation DSL. For instance, if you want to enforce that a certain value is
a number, you can define something like this:

```javascript
const numSchema = yup.number();
```

You can then validate anything against that schema.

```javascript
const validator = (val) => {
  numSchema.validate(val)
    .then(result => {
      console.log(result); // it is the value of `val`
      return true;
    })
    .catch(error => {
      console.log(error.errors); // array of validation error messages
      return false;
    });
};
```

The validation is async, so if it succeeds the `then` block is hit. If the
validation fails, it will fall through to the `catch`.

```javascript
validator(5) // => true
validator('what') // => false
```

